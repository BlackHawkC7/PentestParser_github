#ifndef PENTOOLNMAP_H
#define PENTOOLNMAP_H

#include <QProcess>
#include <QDebug>
#include <QObject>
#include <QDir>
#include <QFileInfo>
#include <QCoreApplication>
#include <QtXml>

#include "resultnmap.h"


class PenToolNmap : public QObject
{
    Q_OBJECT
public:
    PenToolNmap();
    PenToolNmap(QString inputFilePath);
    void parse(QString resultFileFormat);
    void run(QString nmapFolderPath, QString runArguments);

private:
    QProcess process;
    QDomDocument xmlFile;
    ResultNmap result;

private slots:
    void processStatusChanged(QProcess::ProcessState state);
    void processFinished(int exitCode, QProcess::ExitStatus exitStatus);
    void processError(QProcess::ProcessError error);
};

#endif // PENTOOLNMAP_H
