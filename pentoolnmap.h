#ifndef PENTOOLNMAP_H
#define PENTOOLNMAP_H

#include <QProcess>
#include <QDebug>
#include <QObject>
#include <QDir>
#include <QFileInfo>
#include <QCoreApplication>
#include <QtXml>

#include "resultnmap.h"


class PenToolNmap : public QObject
{
    Q_OBJECT
public:
    PenToolNmap();
    PenToolNmap(QString filePath);
    void parse();
    void run(QString runArguments);

private:
    //QString runArguments;
    QProcess process;
    //QString resultString;
    QFile file;
    QDomDocument xmlFile;
    ResultNmap result;

private slots:
    void processReadyToRead();
    void processStatusChanged(QProcess::ProcessState state);
    void processFinished(int exitCode, QProcess::ExitStatus exitStatus);
    void processError(QProcess::ProcessError error);

};

#endif // PENTOOLNMAP_H
