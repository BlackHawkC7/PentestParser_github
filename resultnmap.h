#ifndef RESULTNMAP_H
#define RESULTNMAP_H

#include <QObject>
#include <QDateTime>
#include <QFile>
#include <QXmlStreamWriter>
#include <QJsonObject>
#include <QJsonDocument>
#include <QJsonArray>
#include <QJsonValue>
#include <QDebug>

struct hop {
    double rtt;
    QString ipAddress;
};

struct os {
    QString name;
    uint accuracy;
};

struct port {
    uint number;
    QString protocol;
    QString state;
    QString service;
    QString serviceName;
    QString serviceVersion;
};

struct host {
    QString ipAddress;
    QString macAddress;
    QString vendor;
    QList<port> portList;
    QList<os> osList;

    uint uptime;
    int networkDistance;
    QList<hop> hopList;
};


class ResultNmap
{
public:
    ResultNmap();
    void toXmlFile();
    void toJsonFile();

    void setStartTimestamp(const QDateTime &value);
    void setStopTimestamp(const QDateTime &value);
    void setTestDuration(const qint64 &value);
    void setNmapVersion(const QString &value);
    void setRunAttributes(const QString &value);
    void setDoneMessage(const QString &value);

    void setHostList(const QList<host> &value);

    QList<host> getHostList() const;

private:
    QDateTime startTimestamp;
    QDateTime stopTimestamp;
    qint64 testDuration;
    QString nmapVersion;
    QString runAttributes;
    QString doneMessage;

    QList<host> hostList;
};

#endif // RESULTNMAP_H
